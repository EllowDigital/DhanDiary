Firestore database structure for DhanDiary

Top-level collection: users
- Document ID: Firebase Auth UID (string)
- Fields:
  - displayName: string
  - email: string
  - photoURL: string | null
  - providers: string[] (e.g., ["password","google"]) 
  - createdAt: Timestamp
  - updatedAt: Timestamp
  - lastLoginAt: Timestamp

Example: users/{uid}
{
  "displayName": "Alice Example",
  "email": "alice@example.com",
  "photoURL": null,
  "providers": ["password"],
  "createdAt": "2025-12-18T00:00:00.000Z",
  "updatedAt": "2025-12-18T00:00:00.000Z",
  "lastLoginAt": "2025-12-18T00:00:00.000Z"
}

Subcollection: users/{uid}/cash_entries
- Purpose: store each income/expense entry for a user
- Document ID: entry ID (UUID/local_id)
- Supported field shapes:
  - Expanded (readable):
    - amount: number (currency units, e.g., 12.50)
    - category: string
    - note: string | null
    - type: "in" | "out"
    - currency: string (e.g., "INR")
    - date: ISO string (e.g., "2025-12-18T10:00:00.000Z")
    - createdAt: Timestamp or ISO string
    - updatedAt: Timestamp or ISO string
  - Compressed (used by sync engine):
    - i: string (local_id)
    - a: integer (amount in cents, e.g., 1250)
    - c: string (category)
    - n: string | null (note)
    - t: "in" | "out"
    - cu: string (currency)
    - d: ISO string (date)
    - u: number (updatedAt in ms)
    - di: string | null (device id)
    - del: boolean (deleted)
    - v: number (version)

Example (expanded): users/{uid}/cash_entries/{entryId}
{
  "amount": 250.5,
  "category": "groceries",
  "note": "Weekly shopping",
  "type": "out",
  "currency": "INR",
  "date": "2025-12-18T10:00:00.000Z",
  "createdAt": "2025-12-18T10:00:00.000Z",
  "updatedAt": "2025-12-18T10:00:00.000Z"
}

Example (compressed equivalent):
{
  "i": "9f1b2c3d-...",
  "a": 25050,
  "c": "groceries",
  "n": "Weekly shopping",
  "t": "out",
  "cu": "INR",
  "d": "2025-12-18T10:00:00.000Z",
  "u": 1702874400000,
  "di": null,
  "del": false,
  "v": 1
}

Subcollection: users/{uid}/summaries/{period}/items/{key}
- Purpose: precomputed aggregates for fast stats
- period values: daily, monthly, yearly
- Document ID (key):
  - daily: YYYY-MM-DD (e.g., 2025-12-18)
  - monthly: YYYY-MM (e.g., 2025-12)
  - yearly: YYYY (e.g., 2025)
- Fields:
  - totalInCents: integer
  - totalOutCents: integer
  - count: integer
  - updatedAt: Timestamp

Example: users/{uid}/summaries/daily/items/2025-12-18
{
  "totalInCents": 50000,
  "totalOutCents": 12550,
  "count": 5,
  "updatedAt": "2025-12-18T11:00:00.000Z"
}

Queries and Indexes (what the app uses):
- Read recent entries: orderBy('date', 'desc'), orderBy('createdAt', 'desc'), limit(...)
- Incremental sync: orderBy('u' or 'updatedAt'), where('u'|'updatedAt', '>', lastPulled)
- Recommended indexes (create in Console if you see errors):
  - users/{uid}/cash_entries: composite index on (date desc, createdAt desc)
  - users/{uid}/cash_entries: index on 'u' (or 'updatedAt') for sync queries

Quick recreate steps (Firebase Console):
1. Open Firebase Console → Firestore Database → Create database (if not created).
2. Create collection `users` and add a document with ID = a test UID.
3. Add fields on that user doc using the `users/{uid}` example above.
4. Under the user doc, add collection `cash_entries` and create documents using the expanded example. Use UUIDs as doc IDs.
5. Under the user doc, add collection `summaries`, then add subcollections `daily`, `monthly`, `yearly`. Under each, add subcollection `items` and create docs keyed by date/month/year using the example fields.

Optional: seeding script
- If you want a programmatic seed, I can add a small Node script using `firebase-admin` to write sample users, entries and summaries. Ask and I'll create it.

Notes:
- The app accepts both expanded and compressed entry shapes; compressed keys are used by the sync engine to reduce upload size.
- Use ISO timestamps or Firestore Timestamps for `createdAt`/`updatedAt`.
- Ensure Authentication users exist with matching UIDs for real app flows (Auth + Firestore profile doc).
